(this.webpackJsonpplanningpoker=this.webpackJsonpplanningpoker||[]).push([[0],{20:function(e){e.exports=JSON.parse('{"c":"0.0.1","a":{"url":"https://github.com/topicusoverheid","name":"Topicus Overheid","email":"info@topicusoverheid.nl"},"b":{"url":"https://github.com/topicusoverheid/planningpoker"}}')},55:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=55},61:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n(0),r=n.n(a),i=n(18),s=n.n(i),o=(n(47),n(22)),l=n(6),j=n(31),u=n(70),b=n(69),d=n(8),h=n(64),O=n(65),p=n(14),m=n(23),x=n(73),f=n(74),g={Classic:[0,1,2,3,5,8,13,20,40,100],Fibonacci:[0,1,2,3,5,8,13,21,34,55,89]},v=n(34),k=n.n(v);var S=function(e){e.peerId;var t=e.state,n=e.onSelectPoints,r=Object(a.useState)(void 0),i=Object(d.a)(r,2),s=i[0],o=i[1];function l(e){e===s?(o(void 0),n(void 0)):(o(e),n(e))}Object(a.useEffect)((function(){o(void 0)}),[t.subject]);var j=t.users.length,u=t.users.filter((function(e){return e.voted})).length,b=j===u,h=0;t.users.forEach((function(e){return h+=e.points||0}));var O=h/t.users.length,m=b&&1===new Set(t.users.map((function(e){return e.points}))).size;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"d-flex justify-content-center",children:Object(c.jsx)(x.a,{size:"lg",children:g[t.pokerPoints].map((function(e){return Object(c.jsx)(x.a.Item,{disabled:0===t.subject.length,active:e===s,onClick:l.bind(null,e),children:e},e)}))})}),Object(c.jsx)(f.a,{now:100*u/j,label:"".concat(u,"/").concat(j),variant:b?"primary":"danger",className:"mb-3"}),Object(c.jsx)("h2",{className:"d-flex justify-content-center",children:O&&Object(c.jsx)(k.a,{end:Math.ceil(O)})||"???"}),Object(c.jsx)("h2",{className:"d-flex justify-content-center",children:Object(c.jsx)(p.c,{style:{opacity:b?1:0},className:b&&m?"text-success":"text-danger"})}),Object(c.jsx)("div",{className:"d-flex justify-content-center",children:t.users.map((function(e,t){return Object(c.jsxs)("div",{className:"img-thumbnail",style:{width:128},title:e.name,children:[Object(c.jsx)("h6",{className:"text-center text-muted",children:"number"===typeof e.points?Object(c.jsx)(k.a,{end:e.points}):e.voted?"!!!":"???"}),Object(c.jsx)("div",{className:"d-flex justify-content-center",children:e.voted?Object(c.jsx)(p.d,{className:e.voted?"text-primary":"text-danger",size:"80%"}):Object(c.jsx)(p.e,{className:e.voted?"text-primary":"text-danger",size:"80%"})}),Object(c.jsx)("h5",{className:"text-center text-truncate",children:e.name})]},t)}))})]})},y=n(35);var C=function(e){var t=e.match.params.id,n=Object(a.useState)(null),r=Object(d.a)(n,2),i=r[0],s=r[1],o=Object(m.useReceivePeerState)(t,{brokerId:""},{metadata:{name:localStorage.getItem("name")}}),l=Object(d.a)(o,5),j=l[0],u=l[1],b=l[2],x=l[3],f=l[4],g=Object(y.b)(),v=Object(a.useState)(!1),k=Object(d.a)(v,2),C=k[0],N=k[1];Object(a.useEffect)((function(){b&&console.error("PeerJS error: ",b)}),[b]),Object(a.useEffect)((function(){null===f||void 0===f||f.on("call",(function(e){e.answer(new MediaStream),e.on("stream",(function(e){s(e)})),e.on("close",s.bind(null,null))}))}),[x,f]);var P=!1;try{j&&j.subject&&(new URL(j&&j.subject),P=!0)}catch(w){P=!1}return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(c.jsx)("h1",{children:"Poker"}),Object(c.jsx)(h.a,{pill:!0,variant:u&&!b?"success":"danger",children:u&&!b?"Connected":b&&b.toString()||"Connecting..."}),Object(c.jsxs)(O.a,{onClick:function(e){return navigator.clipboard.writeText(window.location.origin+"/join/"+t)},children:[Object(c.jsx)(p.a,{})," Copy invite link"]})]}),P?Object(c.jsx)("a",{href:j&&j.subject,target:"_blank",rel:"noreferrer noopener",children:Object(c.jsx)("h2",{className:"text-truncate text-center",children:j&&j.subject})}):Object(c.jsx)("h2",{className:"text-truncate text-center",children:j&&j.subject||"Waiting for subject..."}),Object(c.jsx)(y.a,{handle:g,children:Object(c.jsxs)("div",{className:"bg-white",children:[i&&j&&j.sharingScreen&&Object(c.jsx)("div",{className:"d-flex justify-content-center",children:Object(c.jsx)("video",{style:{opacity:C?.05:1},onDoubleClick:g.active?g.exit:g.enter,muted:!0,autoPlay:!0,width:(g.active,"100%"),ref:function(e){e&&e.srcObject!==i&&(e.srcObject=i)}})}),Object(c.jsx)("div",{style:{opacity:C?1:.05},className:"container bg-white fixed-bottom mb-5",onMouseEnter:N.bind(null,!0),onMouseLeave:N.bind(null,!1),children:Object(c.jsx)(S,{peerId:f&&f.id||"",state:j||{subject:"",users:[],pokerPoints:"Classic",sharingScreen:!1},onSelectPoints:function(e){return x&&x.send({points:e})}})})]})})]})},N=n(66),P=n(71),w=n(67),E=n(72);var I=function(e){var t=e.history,n=Object(a.useState)(localStorage.getItem("name")||""),r=Object(d.a)(n,2),i=r[0],s=r[1],o=Object(a.useState)(localStorage.getItem("points")||"Classic"),l=Object(d.a)(o,2),j=l[0],u=l[1],b=Object(a.useState)(Object(E.a)()),h=Object(d.a)(b,2),p=h[0],m=h[1];return Object(c.jsxs)(N.a,{children:[Object(c.jsx)("h1",{children:"Welcome to Planning Poker!"}),Object(c.jsx)("p",{children:"Planning Poker is built by Topicus Overheid on innovation day to facilitate remote planning poker."}),Object(c.jsxs)(P.a,{onSubmit:function(e){e.preventDefault(),localStorage.setItem("name",i),localStorage.setItem("points",j),t.push("/poker-admin/"+p)},children:[Object(c.jsxs)(P.a.Group,{children:[Object(c.jsx)(P.a.Label,{children:"Name"}),Object(c.jsx)(P.a.Control,{placeholder:"Name","aria-label":"Name",minLength:3,maxLength:255,isValid:i.length>=3,value:i,onChange:function(e){s(e.target.value)}})]}),Object(c.jsxs)(P.a.Group,{children:[Object(c.jsx)(P.a.Label,{children:"Points"}),Object(c.jsx)(P.a.Control,{as:"select",custom:!0,defaultValue:j,onChange:function(e){u(e.target.value)},children:Object.keys(g).map((function(e){return Object(c.jsxs)("option",{value:e,children:[e," (",g[e].join(", "),")"]},e)}))})]}),Object(c.jsxs)(P.a.Group,{children:[Object(c.jsx)(P.a.Label,{children:"Session ID"}),Object(c.jsxs)(w.a,{children:[Object(c.jsx)(P.a.Control,{placeholder:"Session ID","aria-label":"Session ID",minLength:8,maxLength:255,isValid:p.length>=8,value:p,onChange:function(e){m(e.target.value)}}),Object(c.jsx)(w.a.Append,{children:Object(c.jsx)(O.a,{variant:"outline-secondary",onClick:function(e){return m(Object(E.a)())},children:"Generate"})})]})]}),Object(c.jsx)(O.a,{type:"submit",children:"Start"})]})]})},L=n(25),D=n(68),T=n(39);var J=function(e){var t=e.match,n=(e.history,e.location,t.params.id),r=Object(a.useState)(""),i=Object(d.a)(r,2),s=i[0],o=i[1],l=Object(a.useState)(void 0),j=Object(d.a)(l,2),u=j[0],b=j[1],h=Object(a.useState)({}),x=Object(d.a)(h,2),f=x[0],g=x[1],v=Object(a.useState)(),k=Object(d.a)(v,2),y=k[0],C=k[1],N=Object(m.usePeerState)({subject:"",users:[],pokerPoints:localStorage.getItem("points")||"Classic",sharingScreen:!1},{brokerId:n}),P=Object(d.a)(N,6),E=P[0],I=P[1],J=(P[2],P[3]),M=P[4],F=P[5];Object(a.useEffect)((function(){F&&console.error("PeerJS error: ",F)}),[F]);var z=Object(a.useCallback)((function(e){I(Object(L.a)(Object(L.a)({},E),e))}),[E,I]),V=Object(a.useCallback)((function(){var e=J.filter((function(e){return e.open})).map((function(e){return{peerId:e.peer,name:e.metadata.name,points:f[e.peer],voted:"number"===typeof f[e.peer]}}));return e.push({peerId:n,name:localStorage.getItem("name")||"Admin",points:u,voted:"number"===typeof u}),e.some((function(e){return!e.voted}))&&e.forEach((function(e){return e.points=void 0})),e}),[J,f,u,n]),A=Object(a.useCallback)((function(e,t){var n=M&&M.call(e.peer,t);n&&t.getVideoTracks()[0].addEventListener("ended",(function(){n.close()}))}),[M]),G=Object(a.useCallback)((function(){y&&y.getTracks().forEach((function(e){return e.stop()})),"getDisplayMedia"in navigator.mediaDevices?navigator.mediaDevices.getDisplayMedia({}).then((function(e){C(e),e.getVideoTracks()[0].addEventListener("ended",(function(){C(null)})),J.forEach((function(t){t.open&&A(t,e)}))})):alert("Screen sharing is not supported.")}),[y,J,A]),R=Object(a.useCallback)((function(e,t){f[e]=t,g(Object(L.a)({},f))}),[f]),_=Object(a.useCallback)((function(e){b(e),R(n,e)}),[n,R]),B=Object(a.useCallback)((function(){b(void 0),o(""),g({}),z({subject:"",users:V()})}),[V,z]);return Object(a.useEffect)((function(){z({sharingScreen:null!=y})}),[y]),Object(a.useEffect)((function(){J.forEach((function(e){e.metadata.initialized||(e.open=!0,e.metadata.initialized=!0,e.on("open",(function(){y&&A(e,y)})),e.on("data",(function(t){t&&"points"in t&&R(e.peer,t.points)})))}))}),[J,y,A,R]),Object(a.useEffect)((function(){z({users:V()})}),[V]),Object(a.useEffect)((function(){return function(){y&&y.getTracks().forEach((function(e){return e.stop()}))}}),[y]),Object(a.useEffect)((function(){return function(){M&&M.destroy()}}),[M]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[Object(c.jsx)("h1",{children:"Poker Admin"}),Object(c.jsxs)(D.a,{children:["getDisplayMedia"in navigator.mediaDevices&&Object(c.jsxs)(O.a,{onClick:G,children:[Object(c.jsx)(p.b,{})," Share screen"]}),Object(c.jsxs)(O.a,{onClick:function(e){return navigator.clipboard.writeText(window.location.origin+"/join/"+n)},children:[Object(c.jsx)(p.a,{})," Copy invite link"]})]})]}),Object(c.jsxs)(w.a,{className:"mb-3",children:[Object(c.jsx)(T.a,{placeholder:"Subject","aria-label":"Subject",value:s,onChange:function(e){o(e.target.value),z({subject:e.target.value})}}),Object(c.jsx)(w.a.Append,{children:Object(c.jsx)(O.a,{variant:"outline-secondary",onClick:B,children:"Reset"})})]}),Object(c.jsx)(S,{peerId:n,state:E,onSelectPoints:_})]})};var M=function(e){var t=e.match,n=e.history,r=t.params.id,i=Object(a.useState)(localStorage.getItem("name")||""),s=Object(d.a)(i,2),o=s[0],l=s[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("h1",{children:["Join ",r]}),Object(c.jsxs)(P.a,{onSubmit:function(e){e.preventDefault(),localStorage.setItem("name",o),n.push("/poker/"+r)},children:[Object(c.jsxs)(P.a.Group,{children:[Object(c.jsx)(P.a.Label,{children:"Name"}),Object(c.jsx)(P.a.Control,{placeholder:"Name","aria-label":"Name",minLength:3,maxLength:255,isValid:o.length>=3,value:o,onChange:function(e){return l(e.target.value)}})]}),Object(c.jsx)(O.a,{type:"submit",children:"Start"})]})]})},F=n(20);var z=function(){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("h1",{children:["About Planning Poker ",F.c]}),Object(c.jsxs)("p",{children:["Planning Poker is an opensource planning poker tool built on innovation day by ",F.a.name]}),Object(c.jsx)("a",{href:F.b.url,children:F.b.url}),Object(c.jsx)("h2",{children:"PeerJS"}),Object(c.jsx)("p",{children:"Planning Poker uses PeerJS for peer-to-peer communication, for setting up peer-to-peer connections PeerJS uses the PeerServer Cloud service."}),Object(c.jsx)("a",{href:"https://peerjs.com/peerserver.html",target:"_blank",rel:"noreferrer noopener",children:"Read more"})]})};var V=function(){return Object(c.jsxs)(o.BrowserRouter,{children:[Object(c.jsx)(u.a,{bg:"dark",variant:"dark",children:Object(c.jsx)(b.a,{children:Object(c.jsx)(j.LinkContainer,{to:"/",children:Object(c.jsxs)(u.a.Brand,{children:[Object(c.jsx)("img",{alt:"Logo",src:"/icon.png",width:"30",height:"30",className:"d-inline-block align-top img-thumbnail rounded-circle"})," Planning Poker"]})})})}),Object(c.jsxs)(b.a,{children:[Object(c.jsx)(l.d,{exact:!0,path:"/",component:I}),Object(c.jsx)(l.d,{exact:!0,path:"/poker-admin/:id",component:J}),Object(c.jsx)(l.d,{exact:!0,path:"/poker/:id",component:C}),Object(c.jsx)(l.d,{exact:!0,path:"/join/:id",component:M}),Object(c.jsx)(l.d,{exact:!0,path:"/about",component:z})]}),Object(c.jsx)("footer",{className:"py-3 fixed-bottom bg-light",children:Object(c.jsx)(b.a,{children:Object(c.jsx)(j.LinkContainer,{to:"/about",children:Object(c.jsx)("span",{className:"text-muted",children:"Planning Poker \xa9 Topicus Overheid 2020"})})})})]})};s.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(V,{})}),document.getElementById("root"))}},[[61,1,2]]]);
//# sourceMappingURL=main.c93a0248.chunk.js.map